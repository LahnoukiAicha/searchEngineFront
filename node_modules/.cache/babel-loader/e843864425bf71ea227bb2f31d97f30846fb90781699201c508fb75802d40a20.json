{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useLocation,useNavigate}from'react-router-dom';import'./SearchResults.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SearchResults=()=>{var _location$state,_results$pdfs,_results$videos;const location=useLocation();const navigate=useNavigate();const[results,setResults]=useState(null);const[query,setQuery]=useState(((_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.query)||'');// Initial search terms\nconst[searchTerm,setSearchTerm]=useState('');// Current search terms for a new search\n// Function to handle a new search submission\nconst handleSearchSubmit=async e=>{e.preventDefault();if(searchTerm.trim()){try{const youtubeApiKey='AIzaSyCJsY2i6l0-nYeaNNMCq2ubdhmCSMjQqic';// Use .env in production\nconst response=await fetch(`http://localhost:5000/search?query=${encodeURIComponent(searchTerm)}&youtube_api_key=${youtubeApiKey}`);const data=await response.json();navigate('/results',{state:{query:searchTerm,searchResults:data}});}catch(error){console.error('Error fetching search results:',error);setResults({error:'Failed to fetch search results. Please try again.'});}}};// Retrieve search results from the previous page or handle missing results\nuseEffect(()=>{var _location$state2;const searchResults=(_location$state2=location.state)===null||_location$state2===void 0?void 0:_location$state2.searchResults;if(searchResults){setResults(searchResults);}else{navigate('/');// Redirect to home if results are absent\n}},[location.state,navigate]);// Show a loading spinner if results are not yet available\nif(!results){return/*#__PURE__*/_jsx(\"div\",{className:\"loading-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner\",children:\"Loading...\"})});}// Show an error message if results failed to load\nif(results.error){return/*#__PURE__*/_jsxs(\"div\",{className:\"error-message\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"error-icon\",children:\"\\u26A0\\uFE0F\"}),results.error]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"search-results-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"search-bar-container\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSearchSubmit,className:\"search-form\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search again...\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),className:\"search-input\",\"aria-label\":\"Search again\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"search-button\",\"aria-label\":\"Search\",children:\"Search\"})]})}),/*#__PURE__*/_jsx(\"h2\",{children:query?`Search Results for: ${query}`:'Search Results'}),/*#__PURE__*/_jsxs(\"div\",{className:\"results-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"results-column\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"PDF Results\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"pdf-list\",children:((_results$pdfs=results.pdfs)===null||_results$pdfs===void 0?void 0:_results$pdfs.length)>0?results.pdfs.map((pdf,index)=>/*#__PURE__*/_jsx(\"li\",{className:\"pdf-result-item\",children:/*#__PURE__*/_jsxs(\"a\",{href:pdf.link,target:\"_blank\",rel:\"noopener noreferrer\",className:\"pdf-link\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"pdf-icon\",children:\"\\uD83D\\uDCC4\"}),pdf.title,\" - \",pdf.authors]})},index)):/*#__PURE__*/_jsx(\"p\",{children:\"No PDF results found.\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"results-column\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Video Results\"}),/*#__PURE__*/_jsx(\"div\",{className:\"video-grid\",children:((_results$videos=results.videos)===null||_results$videos===void 0?void 0:_results$videos.length)>0?results.videos.map((video,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"video-item\",children:[/*#__PURE__*/_jsx(\"a\",{href:video.link,target:\"_blank\",rel:\"noopener noreferrer\",children:/*#__PURE__*/_jsx(\"img\",{src:video.thumbnail,alt:video.title,className:\"video-thumbnail\"})}),/*#__PURE__*/_jsx(\"p\",{children:video.title})]},index)):/*#__PURE__*/_jsx(\"p\",{children:\"No video results found.\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"results-column\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Image Results\"}),/*#__PURE__*/_jsx(\"div\",{className:\"image-grid\",children:Object.entries(results.image_keywords||{}).length>0?Object.entries(results.image_keywords).map(_ref=>{let[fileName,data]=_ref;return/*#__PURE__*/_jsx(\"div\",{className:\"image-result\",children:/*#__PURE__*/_jsx(\"img\",{src:`http://localhost:5000${data.image_path}`,alt:fileName,className:\"result-image\"})},fileName);}):/*#__PURE__*/_jsx(\"p\",{children:\"No image results found.\"})})]})]})]});};export default SearchResults;","map":{"version":3,"names":["React","useEffect","useState","useLocation","useNavigate","jsx","_jsx","jsxs","_jsxs","SearchResults","_location$state","_results$pdfs","_results$videos","location","navigate","results","setResults","query","setQuery","state","searchTerm","setSearchTerm","handleSearchSubmit","e","preventDefault","trim","youtubeApiKey","response","fetch","encodeURIComponent","data","json","searchResults","error","console","_location$state2","className","children","onSubmit","type","placeholder","value","onChange","target","pdfs","length","map","pdf","index","href","link","rel","title","authors","videos","video","src","thumbnail","alt","Object","entries","image_keywords","_ref","fileName","image_path"],"sources":["C:/Users/Aicha LAHNOUKI/Desktop/S5/SRI et bigdata/searchEngineProject/front/src/components/SearchResults.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useLocation, useNavigate } from 'react-router-dom';\r\nimport './SearchResults.css';\r\n\r\nconst SearchResults = () => {\r\n  const location = useLocation();\r\n  const navigate = useNavigate();\r\n  const [results, setResults] = useState(null);\r\n  const [query, setQuery] = useState(location.state?.query || ''); // Initial search terms\r\n  const [searchTerm, setSearchTerm] = useState(''); // Current search terms for a new search\r\n\r\n  // Function to handle a new search submission\r\n  const handleSearchSubmit = async (e) => {\r\n    e.preventDefault();\r\n    if (searchTerm.trim()) {\r\n      try {\r\n        const youtubeApiKey = 'AIzaSyCJsY2i6l0-nYeaNNMCq2ubdhmCSMjQqic'; // Use .env in production\r\n        const response = await fetch(\r\n          `http://localhost:5000/search?query=${encodeURIComponent(searchTerm)}&youtube_api_key=${youtubeApiKey}`\r\n        );\r\n        const data = await response.json();\r\n        navigate('/results', { state: { query: searchTerm, searchResults: data } });\r\n      } catch (error) {\r\n        console.error('Error fetching search results:', error);\r\n        setResults({ error: 'Failed to fetch search results. Please try again.' });\r\n      }\r\n    }\r\n  };\r\n\r\n  // Retrieve search results from the previous page or handle missing results\r\n  useEffect(() => {\r\n    const searchResults = location.state?.searchResults;\r\n    if (searchResults) {\r\n      setResults(searchResults);\r\n    } else {\r\n      navigate('/'); // Redirect to home if results are absent\r\n    }\r\n  }, [location.state, navigate]);\r\n\r\n  // Show a loading spinner if results are not yet available\r\n  if (!results) {\r\n    return (\r\n      <div className=\"loading-container\">\r\n        <div className=\"spinner\">Loading...</div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Show an error message if results failed to load\r\n  if (results.error) {\r\n    return (\r\n      <div className=\"error-message\">\r\n        <span className=\"error-icon\">‚ö†Ô∏è</span>\r\n        {results.error}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"search-results-container\">\r\n      {/* Search bar for a new search */}\r\n      <div className=\"search-bar-container\">\r\n        <form onSubmit={handleSearchSubmit} className=\"search-form\">\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Search again...\"\r\n            value={searchTerm}\r\n            onChange={(e) => setSearchTerm(e.target.value)}\r\n            className=\"search-input\"\r\n            aria-label=\"Search again\"\r\n          />\r\n          <button type=\"submit\" className=\"search-button\" aria-label=\"Search\">\r\n            Search\r\n          </button>\r\n        </form>\r\n      </div>\r\n\r\n      <h2>{query ? `Search Results for: ${query}` : 'Search Results'}</h2>\r\n\r\n      <div className=\"results-section\">\r\n        {/* PDF Results */}\r\n        <div className=\"results-column\">\r\n          <h3>PDF Results</h3>\r\n          <ul className=\"pdf-list\">\r\n            {results.pdfs?.length > 0 ? (\r\n              results.pdfs.map((pdf, index) => (\r\n                <li key={index} className=\"pdf-result-item\">\r\n                  <a href={pdf.link} target=\"_blank\" rel=\"noopener noreferrer\" className=\"pdf-link\">\r\n                    <span className=\"pdf-icon\">üìÑ</span>\r\n                    {pdf.title} - {pdf.authors}\r\n                  </a>\r\n                </li>\r\n              ))\r\n            ) : (\r\n              <p>No PDF results found.</p>\r\n            )}\r\n          </ul>\r\n        </div>\r\n\r\n        {/* Video Results */}\r\n        <div className=\"results-column\">\r\n          <h3>Video Results</h3>\r\n          <div className=\"video-grid\">\r\n            {results.videos?.length > 0 ? (\r\n              results.videos.map((video, index) => (\r\n                <div key={index} className=\"video-item\">\r\n                  <a href={video.link} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                    <img src={video.thumbnail} alt={video.title} className=\"video-thumbnail\" />\r\n                  </a>\r\n                  <p>{video.title}</p>\r\n                </div>\r\n              ))\r\n            ) : (\r\n              <p>No video results found.</p>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Image Results */}\r\n        <div className=\"results-column\">\r\n          <h3>Image Results</h3>\r\n          <div className=\"image-grid\">\r\n            {Object.entries(results.image_keywords || {}).length > 0 ? (\r\n              Object.entries(results.image_keywords).map(([fileName, data]) => (\r\n                <div key={fileName} className=\"image-result\">\r\n                  <img\r\n                    src={`http://localhost:5000${data.image_path}`}\r\n                    alt={fileName}\r\n                    className=\"result-image\"\r\n                  />\r\n                </div>\r\n              ))\r\n            ) : (\r\n              <p>No image results found.</p>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SearchResults;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}